<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>dataScraping</title>
	<link rel="stylesheet" type="text/css" href="css/style.css" />
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
	<script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.0.js"
		integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
	<script src="./js/bootstrap.js"></script>
	<script src="./js/jqurey.number.js"></script>
	<!-- echarts -->
	<script src="./js/echarts.min.js"></script>
<script src="js/esl.js"></script>
<script src="js/jquery-1.7.1.js"></script>
<script type="text/javascript">
/**
实验 2个动态图展示，变化方式不同

*/

var myChart = echarts.init(document.getElementById('main'));

var now = new Date();
var len = 10;
var res = [];
while (len--) {
res.unshift(now.toLocaleTimeString().replace(/^\D*/,''));
    now = new Date(now - 2000);
}
var res1 = [];
var res2 = [];
var len = 10;
while (len--) {
  res1.push((Math.random()*10 + 5).toFixed(1) - 0);
  res2.push((Math.random()*10 + 5).toFixed(1) + 10);
}
var xAxisData = res; //x轴数据
var yAxisData = res1; //y轴数据
var yAxisData2 = res2; //y轴数据
// 指定图表的配置项和数据
var option = {
title : {
    text: '实时销售数据'
},
tooltip : {
        trigger: 'axis'
    },
    legend: {
        data:['销量1', '销量2']
    },
    toolbox: {
        show : true,
        feature : {
            //dataView : {show: true, readOnly: false},
            magicType : {show: true, type: ['line', 'bar']},
            restore : {show: true},
            saveAsImage : {show: true}
        }
    },
    dataZoom : {
        show : false,
        start : 0,
        end : 100
    },
    xAxis : [
        {
            type : 'category',
            boundaryGap : true,
            data:xAxisData
        }
   ],
   yAxis : [
      {
           type : 'value',
           scale: true,
           name : '销量',
           boundaryGap: [0.2, 0.2]
      }
  ],
  series : [
       {
            name:'销量1',
            type:'line',
            lineStyle: {
            normal: {
              //color: '#4F2F4F',
              width: 2
              //type: solid
            },
            },
            data:yAxisData
       },
       {
           name:'销量2',
           type:'line',
           lineStyle: {
            normal: {
              //color: '#4F2F4F',
              width: 2
              //type: solid
            },
           },
           data:yAxisData2
      }
  ]
};
var lastData = 11;
var lastData2;
var axisData;
clearInterval(app);
var app = {};
app.timeTicket = setInterval(function (){
  var url = "redis.json?value=value1";
  var paramData={};
  $.ajax({
      url: url,
      type: 'post',
      data: paramData,
      dataType: 'json',
      async:false,
      error:function(){
          console.log("get redis error!!!")
      },
      success: function(result){
          if(result != null){
        axisData = result.result.dateTime;
          lastData = result.result.sales;
          lastData2 = parseInt(lastData)+10;
          }
      }
  }); 
    // 动态数据接口 addData
    myChart.addData([
        [
            0,        // 系列索引
            lastData, // 新增数据
            false,     // 新增数据是否从队列头部插入
            false,    // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
            axisData //横轴数据
        ],
        [
            1,        // 系列索引
            lastData2, // 新增数据
            false,     // 新增数据是否从队列头部插入
            false,    // 是否增加队列长度，false则自定删除原有数据，队头插入删队尾，队尾插入删队头
            axisData //横轴数据
        ]
    ]);
}, 5000);
</script>
</head>
<body>
  <div id="main" style="width: 100%;height:500px;"></div>

</body>
</html>
